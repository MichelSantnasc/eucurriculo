<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gerador de CV Fácil - Crie Seu Currículo Profissional</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    /* Estilos Globais e Reset */
    * { 
        box-sizing: border-box; 
    }
    body { 
        font-family: 'Roboto', sans-serif; 
        margin: 0; padding: 0; 
        background: linear-gradient(135deg, #f0f0f0 0%, #e0e0e0 100%); /* Fundo claro */
        min-height: 100vh;
        color: #333;
        line-height: 1.6;
    }
    a {
        color: #000;
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }

    /* Estrutura Principal */
    header {
        background-color: #000;
        color: #fff;
        padding: 20px 0;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    header h1 {
        margin: 0;
        font-weight: 700; /* Nome do site mais forte */
        font-size: 2.2em; /* Nome maior */
    }
    header p {
        margin: 5px 0 0;
        font-weight: 300;
        font-size: 0.9em;
    }
    .container {
        max-width: 900px;
        margin: 30px auto;
        padding: 0 20px;
    }
    #cv-form {
        background-color: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }

    /* Estilos de Formulário */
    input[type="text"],
    input[type="email"],
    input[type="url"],
    input[type="number"],
    input[type="tel"],
    select,
    textarea {
        width: 100%;
        padding: 10px 15px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 1em;
        font-family: 'Roboto', sans-serif;
        transition: border-color 0.3s;
    }
    input[type="file"] {
        padding: 8px;
    }
    select {
        appearance: none; /* Remove seta padrão em alguns browsers */
        padding-right: 30px;
    }
    input:focus,
    select:focus,
    textarea:focus {
        border-color: #000; /* Preto no foco */
        outline: none;
    }
    textarea {
        resize: vertical;
    }
    label {
        display: block;
        margin-bottom: 5px;
        font-weight: 500;
        color: #333;
    }
    
    .input-group {
        display: flex;
        gap: 10px;
    }
    .input-group input, .input-group select {
        flex: 1;
    }
    .input-group label {
        flex: 1;
    }

    /* Accordion (Seções) */
    .accordion-section {
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-bottom: 15px;
        overflow: hidden;
    }
    .accordion-header {
        background-color: #f7f7f7;
        padding: 15px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #ddd;
        transition: background-color 0.3s;
    }
    .accordion-section.open .accordion-header {
        background-color: #eee;
    }
    .accordion-header h2 {
        margin: 0;
        font-size: 1.1em;
        font-weight: 500;
        color: #333;
    }
    .accordion-header .arrow {
        transition: transform 0.3s;
        color: #555;
    }
    .accordion-section.open .accordion-header .arrow {
        transform: rotate(180deg);
    }
    .accordion-content {
        padding: 0 15px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s ease-in-out, padding 0.3s;
    }
    .accordion-section.open .accordion-content {
        padding: 15px;
    }

    /* Botões */
    .button-group {
        margin-top: 30px;
        display: flex;
        gap: 15px;
        justify-content: center;
    }
    .action-btn {
        padding: 12px 25px;
        font-size: 1em;
        font-weight: 700;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        transition: background-color 0.3s, transform 0.1s;
        color: #fff;
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
        max-width: 250px;
        justify-content: center;
    }
    .preview {
        background-color: #000; /* Preto */
    }
    .preview:hover {
        background-color: #333;
    }
    .download {
        background-color: #555; /* Cinza Escuro */
    }
    .download:hover {
        background-color: #777;
    }
    .test-data {
        background-color: #000; 
        opacity: 0.8;
    }
    .test-data:hover {
        background-color: #333;
    }

    .add-btn {
        background-color: #000;
        color: #fff;
        border: none;
        padding: 8px 15px;
        margin-top: 10px;
        margin-bottom: 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9em;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: background-color 0.3s;
    }
    .add-btn:hover {
        background-color: #333;
    }
    .remove-btn {
        background-color: #dc3545; /* Vermelho */
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.8em;
        transition: background-color 0.3s;
    }
    .remove-btn:hover {
        background-color: #c82333;
    }

    /* Estilos de Campos Repetidos (Telefone, Experiência, etc.) */
    .telefone-item, .experiencia, .educacao-item, .idioma-item {
        border: 1px solid #ddd;
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 4px;
        background-color: #fafafa;
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        align-items: center;
    }

    .telefone-item .telefone-group {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .telefone-item .telefone-group input[type="tel"] {
        margin-bottom: 0;
    }
    .whatsapp-checkbox {
        display: flex;
        align-items: center;
        gap: 5px;
        font-weight: 400;
        white-space: nowrap;
    }
    .whatsapp-checkbox input {
        width: auto;
        margin: 0;
    }
    .experiencia input, .educacao-item input, .idioma-item input, .experiencia textarea, .educacao-item select {
        margin-bottom: 5px;
    }
    .experiencia, .educacao-item, .idioma-item {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: flex-end;
    }
    .experiencia .cargo, .experiencia .empresa, .educacao-item .instituicao, .idioma-item .idioma-nome {
        flex: 1 1 45%;
        min-width: 150px;
    }
    .experiencia .periodo {
        flex: 1 1 30%;
        min-width: 100px;
    }
    .experiencia .descricao {
        flex: 1 1 100%;
        min-width: 100%;
        margin-top: 5px;
    }
    .educacao-item .tipo-educacao {
        flex: 1 1 30%;
        min-width: 100px;
    }
    .educacao-item .input-group {
        flex: 1 1 30%;
        min-width: 100px;
    }
    .idioma-item .nivel-idioma {
        flex: 1 1 30%;
        min-width: 100px;
    }
    .remove-btn {
        flex-shrink: 0;
        align-self: flex-start;
        margin-left: auto;
    }
    
    .subsection-title {
        border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
        margin-top: 10px;
        margin-bottom: 15px;
        font-size: 1em;
        font-weight: 500;
        color: #000;
    }

    /* Notificações */
    .notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        opacity: 0;
        transition: opacity 0.5s, transform 0.5s;
        transform: translateY(20px);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .notification.show {
        opacity: 1;
        transform: translateY(0);
    }
    .notification.success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    .notification.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    /* Pré-visualização */
    #preview {
        margin-top: 30px;
        padding: 30px;
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        color: #000; /* Força o preto para o tema clássico */
    }
    #preview h2 {
        text-align: center;
        font-size: 1.5em;
        margin-top: 0;
        border-bottom: 2px solid #ccc;
        padding-bottom: 10px;
        color: #000;
    }
    #preview h3 {
        font-size: 1.3em;
        margin-bottom: 5px;
    }
    #preview h4 {
        font-size: 1.1em;
        font-weight: 700;
        margin-bottom: 5px;
        padding-bottom: 5px;
    }
    #preview h5 {
        font-size: 1em;
        margin-bottom: 3px;
        font-weight: 600;
    }
    #preview p {
        margin-top: 0;
        margin-bottom: 8px;
    }
    #preview ul {
        list-style-type: disc;
        margin-left: 25px;
        padding-left: 0;
        margin-top: 0;
        margin-bottom: 8px;
    }
    #preview li {
        margin-bottom: 5px;
    }
    .foto-preview {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-right: 20px;
        object-fit: cover;
        border: 1px solid #ccc;
    }

    /* --- NOVOS ESTILOS DE RODAPÉ E DOAÇÃO --- */
    .footer {
        background-color: #000;
        color: #fff;
        padding: 20px 0;
        margin-top: 50px;
        box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
    }

    .footer-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.9em;
    }

    .footer-links {
        display: flex;
        gap: 20px;
        align-items: center;
    }

    .footer a {
        color: #ccc;
        transition: color 0.3s;
    }

    .footer a:hover {
        color: #fff;
        text-decoration: none;
    }

    .developer-link {
        font-weight: 500;
    }

    .donate-btn {
        background-color: #f7a600; /* Cor de destaque para doação (Laranja/Amarelo) */
        color: #000 !important;
        padding: 8px 15px;
        border-radius: 4px;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 5px;
        transition: background-color 0.3s;
        text-decoration: none; /* Garante que não sublinhe */
    }

    .donate-btn:hover {
        background-color: #ffc107;
        text-decoration: none !important;
    }
    /* --- FIM NOVOS ESTILOS --- */


    /* Responsividade */
    @media (max-width: 768px) {
        .container {
            margin: 20px 0;
        }
        #cv-form {
            padding: 20px;
            margin: 0 10px;
        }
        .input-group {
            flex-direction: column;
            gap: 0;
        }
        .button-group {
            flex-direction: column;
            gap: 10px;
        }
        .action-btn {
            max-width: 100%;
        }
        .telefone-item, .experiencia, .educacao-item, .idioma-item {
            grid-template-columns: 1fr;
            flex-direction: column;
            align-items: stretch;
        }
        .remove-btn {
            align-self: stretch;
            margin-left: 0;
        }
        .footer-content {
            flex-direction: column;
            text-align: center;
            gap: 10px;
        }
        .footer-links {
            flex-direction: column;
            gap: 10px;
        }
    }
</style>
  </head>
<body>
    <div id="notification-success" class="notification success"><i class="fas fa-check-circle"></i></div>
    <div id="notification-error" class="notification error"><i class="fas fa-times-circle"></i> <span id="error-message"></span></div>

    <header>
        <h1>EuCurrículo</h1>
        <p>Gerador de CV Fácil - Crie seu currículo profissional em PDF</p>
    </header>

    <main class="container">
        <form id="cv-form">
            <div class="accordion-section open" id="section1">
                <div class="accordion-header" onclick="toggleSection(this)" role="button" aria-expanded="true">
                    <h2><i class="fas fa-user"></i> 1. Dados Pessoais e Contato</h2>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <div class="accordion-content">
                    <div class="form-group">
                        <label for="foto">Foto de Perfil (Opcional, max 2MB):</label>
                        <input type="file" id="foto" accept="image/jpeg,image/png">
                    </div>
                    
                    <div class="input-group">
                        <input type="text" id="nome" placeholder="Nome Completo" required>
                        <input type="email" id="email" placeholder="E-mail" required>
                    </div>

                    <div class="input-group">
                        <input type="text" id="estadoCivil" placeholder="Estado Civil (ex: Solteiro)">
                        <input type="number" id="idade" placeholder="Idade (ex: 30)" min="18" max="99">
                    </div>
                    
                    <div class="input-group">
                        <input type="text" id="cep" placeholder="CEP (ex: 59164-000)" maxlength="9" onblur="buscarCep()">
                        <input type="text" id="cidade" placeholder="Cidade" readonly>
                        <input type="text" id="uf" placeholder="UF" maxlength="2" readonly>
                    </div>
                    
                    <input type="text" id="endereco" placeholder="Endereço (Rua, Número, Bairro - Opcional)">
                    <input type="url" id="linkedin" placeholder="Link do LinkedIn (Opcional)">
                    
                    <label>Telefones (Mínimo 1):</label>
                    <div id="telefones">
                        <div class="telefone-item">
                            <div class="telefone-group">
                                <input type="tel" id="telefone_0" placeholder="(11) 98765-4321" class="telefone" required>
                                <label for="whatsapp_0" class="whatsapp-checkbox"><input type="checkbox" id="whatsapp_0" class="whatsapp"> WhatsApp</label>
                            </div>
                            </div>
                    </div>
                    <button type="button" class="add-btn" onclick="adicionarTelefone()">
                        <i class="fas fa-plus-circle"></i> Adicionar Outro Telefone
                    </button>
                </div>
            </div>

            <div class="accordion-section" id="section2">
                <div class="accordion-header" onclick="toggleSection(this)" role="button" aria-expanded="false">
                    <h2><i class="fas fa-bullseye"></i> 2. Objetivo Profissional</h2>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <div class="accordion-content">
                    <textarea id="objetivo" rows="3" placeholder="Ex: Atuar na área de Logística, utilizando meus 10 anos de experiência para otimizar processos e reduzir custos." required></textarea>
                </div>
            </div>

            <div class="accordion-section" id="section3">
                <div class="accordion-header" onclick="toggleSection(this)" role="button" aria-expanded="false">
                    <h2><i class="fas fa-briefcase"></i> 3. Experiência Profissional</h2>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <div class="accordion-content">
                    <div id="experiencias">
                        <div class="experiencia">
                            <input type="text" placeholder="Cargo" class="cargo" required>
                            <input type="text" placeholder="Empresa" class="empresa" required>
                            <input type="text" placeholder="Período (ex: 2020 - Atual)" class="periodo" required>
                            <textarea placeholder="Descrição (bullets separadas por ponto e vírgula ';')" class="descricao" rows="2"></textarea>
                            </div>
                    </div>
                    <button type="button" class="add-btn" onclick="adicionarExp()">
                        <i class="fas fa-plus-circle"></i> Adicionar Outra Experiência
                    </button>
                </div>
            </div>

            <div class="accordion-section" id="section4">
                <div class="accordion-header" onclick="toggleSection(this)" role="button" aria-expanded="false">
                    <h2><i class="fas fa-graduation-cap"></i> 4. Formação Acadêmica e Idiomas</h2>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <div class="accordion-content">
                    
                    <h3 class="subsection-title">Formação Acadêmica (Mínimo 1)</h3>
                    <div id="educacoes">
                        <div class="educacao-item">
                            <select class="tipo-educacao">
                                <option value="">-- Tipo (opcional) --</option>
                                <option value="Ensino Fundamental">Ensino Fundamental</option>
                                <option value="Ensino Médio">Ensino Médio</option>
                                <option value="Graduação">Graduação</option>
                                <option value="Pós-Graduação">Pós-Graduação</option>
                                <option value="Mestrado">Mestrado</option>
                                <option value="Doutorado">Doutorado</option>
                                <option value="Curso Técnico">Curso Técnico</option>
                            </select>
                            <input type="text" placeholder="Instituição (escola/faculdade)" class="instituicao" required>
                            <div class="input-group">
                                <input type="number" placeholder="Ano Início (opcional)" class="ano-inicio" min="1900" max="2025">
                                <input type="number" placeholder="Ano Término (opcional)" class="ano-termino" min="1900" max="2025">
                            </div>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="adicionarEducacao()">
                        <i class="fas fa-plus-circle"></i> Adicionar Outra Formação
                    </button>
                    
                    <h3 class="subsection-title" style="margin-top: 20px;">Idiomas (Opcional)</h3>
                    <div id="idiomas">
                        <div class="idioma-item">
                            <input type="text" list="idiomas-lista" placeholder="Idioma (ex: Inglês)" class="idioma-nome">
                            <datalist id="idiomas-lista">
                                <option value="Inglês">
                                <option value="Espanhol">
                                <option value="Alemão">
                                <option value="Francês">
                            </datalist>
                            <select class="nivel-idioma">
                                <option value="">-- Nível --</option>
                                <option value="Básico">Básico</option>
                                <option value="Intermediário">Intermediário</option>
                                <option value="Avançado">Avançado</option>
                                <option value="Fluente">Fluente</option>
                                <option value="Nativo">Nativo</option>
                            </select>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="adicionarIdioma()">
                        <i class="fas fa-plus-circle"></i> Adicionar Outro Idioma
                    </button>
                </div>
            </div>

            <div class="accordion-section" id="section5">
                <div class="accordion-header" onclick="toggleSection(this)" role="button" aria-expanded="false">
                    <h2><i class="fas fa-tools"></i> 5. Habilidades e Adicionais</h2>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <div class="accordion-content">
                    <label for="skills">Habilidades (Separe por vírgula ou ponto e vírgula):</label>
                    <textarea id="skills" rows="3" placeholder="Ex: Comunicação, Liderança, JavaScript, Gestão de Projetos, HTML, CSS"></textarea>
                    
                    <label for="adicional" style="margin-top: 15px;">Detalhes Adicionais (Opcional):</label>
                    <textarea id="adicional" rows="3" placeholder="Ex: CNH B e veículo próprio. Disponibilidade para viagens."></textarea>
                </div>
            </div>
            
            <div class="button-group">
                <button type="button" class="action-btn preview" onclick="previewCV()">
                    <i class="fas fa-eye"></i> Pré-visualizar CV
                </button>
                <button type="button" class="action-btn download" onclick="gerarCV()">
                    <i class="fas fa-download"></i> Gerar PDF
                </button>
            </div>
        </form>

        <div id="preview" style="display: none;">
            </div>
    </main>
    
    <footer class="footer">
        <div class="footer-content container">
            <p>&copy; 2024 EuCurrículo. Todos os direitos reservados.</p>
            <div class="footer-links">
                <a href="https://www.instagram.com/michelsantnasc/" target="_blank" class="developer-link">Feito por Santnasc</a>
                <a href="https://pag.ae/7-eLw851" target="_blank" class="donate-btn">
                    <i class="fas fa-hand-holding-heart"></i> Me Paga um Café
                </a>
            </div>
        </div>
    </footer>
    <script>
    let formCompleted = false;
    let fotoBase64 = null;
    
    // Função para mostrar notificação
    function showNotification(type, message) {
        const notif = document.getElementById(`notification-${type}`);
        const msgElement = type === 'error' ? document.getElementById('error-message') : notif;
        if (type === 'error') {
            msgElement.textContent = message;
        } else {
            notif.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
        }
        notif.classList.add('show');
        setTimeout(() => {
            notif.classList.remove('show');
        }, 5000); // Esconde após 5s
    }

    function updateMaxHeight(sectionId) {
        const section = document.getElementById(sectionId);
        if (section && section.classList.contains('open')) {
            const content = section.querySelector('.accordion-content');
            content.style.maxHeight = content.scrollHeight + 'px';
        }
    }

    // Accordion toggle - agora como accordion real (não fecha outras)
    function toggleSection(header) {
        const section = header.parentElement;
        const content = section.querySelector('.accordion-content');
        const headerId = header.id;
        const isOpen = section.classList.contains('open');

        // Toggle só a atual
        if (isOpen) {
            section.classList.remove('open');
            content.style.maxHeight = '0px';
            header.setAttribute('aria-expanded', 'false');
        } else {
            section.classList.add('open');
            setTimeout(() => {
                content.style.maxHeight = content.scrollHeight + 'px';
            }, 0);
            header.setAttribute('aria-expanded', 'true');
        }
    }

    // Initialize first section open
    document.addEventListener('DOMContentLoaded', function() {
        const firstSection = document.querySelector('.accordion-section.open');
        if (firstSection) {
            const firstContent = firstSection.querySelector('.accordion-content');
            const firstHeader = firstSection.querySelector('.accordion-header');
            setTimeout(() => {
                firstContent.style.maxHeight = firstContent.scrollHeight + 'px';
            }, 0);
            firstHeader.setAttribute('aria-expanded', 'true');
        }
        formCompleted = true;

        // Aplicar máscara de telefone em inputs existentes
        document.querySelectorAll('.telefone').forEach(applyPhoneMask);
    });

    // Máscara para telefone brasileiro (11 dígitos ou 10)
    function applyPhoneMask(input) {
        input.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 10) {
                // Fixo: (11) 1234-5678
                value = value.replace(/(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{4})(\d)/, '$1-$2');
            } else {
                // Celular: (11) 9 1234-5678
                value = value.replace(/(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{1})(\d{4})(\d)/, '$1 $2-$3');
            }
            e.target.value = value;
        });

        input.addEventListener('keydown', function(e) {
            // Permitir backspace, delete, etc.
            if (e.key === 'Backspace' || e.key === 'Delete') return;
            // Bloquear se já tem máscara completa
            if (e.target.value.length >= 14) e.preventDefault();
        });
    }

    // Upload de foto para base64 com limite de tamanho
    document.getElementById('foto').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            if (file.size > 2 * 1024 * 1024) { // 2MB
                showNotification('error', 'Foto muito grande! Máximo 2MB.');
                e.target.value = '';
                return;
            }
            const reader = new FileReader();
            reader.onload = function(e) {
                fotoBase64 = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    // Função para formatar telefone (só no PDF/preview) - remove máscara
    function formatarTelefone(telRaw) {
        const digits = telRaw.replace(/\D/g, '');
        if (digits.length === 11) {
            return `(${digits.substring(0,2)}) 9 ${digits.substring(3,7)}-${digits.substring(7,11)}`;
        } else if (digits.length === 10) {
            return `(${digits.substring(0,2)}) ${digits.substring(2,6)}-${digits.substring(6,10)}`;
        }
        return telRaw; // Fallback
    }

    // Função para formatar CEP
    function formatarCep(cepRaw) {
        const digits = cepRaw.replace(/\D/g, '');
        if (digits.length === 8) {
            return `${digits.substring(0,5)}-${digits.substring(5,8)}`;
        }
        return cepRaw; // Fallback
    }

    // Busca CEP via ViaCEP API com timeout
    function buscarCep() {
        const cep = document.getElementById('cep').value.replace(/\D/g, '');
        if (cep.length !== 8) {
            document.getElementById('cidade').value = '';
            document.getElementById('uf').value = '';
            if (cep) showNotification('error', 'CEP deve ter 8 dígitos!');
            return;
        }
        const controller = new AbortController();
        setTimeout(() => controller.abort(), 5000); // 5s timeout
        fetch(`https://viacep.com.br/ws/${cep}/json/`, { signal: controller.signal })
            .then(response => response.json())
            .then(data => {
                if (data.erro) {
                    showNotification('error', 'CEP não encontrado!');
                    document.getElementById('cidade').value = '';
                    document.getElementById('uf').value = '';
                    return;
                }
                document.getElementById('cidade').value = data.localidade;
                document.getElementById('uf').value = data.uf;
            })
            .catch(err => {
                if (err.name === 'AbortError') {
                    showNotification('error', 'Timeout na busca de CEP. Verifique conexão.');
                } else {
                    showNotification('error', 'Erro ao buscar CEP. Verifique conexão.');
                }
                document.getElementById('cidade').value = '';
                document.getElementById('uf').value = '';
            });
    }

    // Telefones - usando um ID único para cada novo elemento
    function adicionarTelefone() {
        const items = document.querySelectorAll('.telefone-item');
        if (items.length >= 5) { 
            showNotification('error', 'Máximo de 5 telefones!'); 
            return; 
        }
        const container = document.getElementById('telefones');
        const div = document.createElement('div');
        const uniqueId = Date.now(); // Unique ID to prevent conflicts on add/remove
        const telId = `telefone_${uniqueId}`;
        const waId = `whatsapp_${uniqueId}`;
        div.className = 'telefone-item';
        div.innerHTML = `
            <div class="telefone-group">
                <input type="tel" id="${telId}" placeholder="(11) 98765-4321" class="telefone" required>
                <label for="${waId}" class="whatsapp-checkbox"><input type="checkbox" id="${waId}" class="whatsapp"> WhatsApp</label>
            </div>
            <button type="button" class="remove-btn" onclick="removerTelefone(this)"><i class="fas fa-trash"></i> Remover</button>
        `;
        container.appendChild(div);
        applyPhoneMask(document.getElementById(telId)); // Aplicar máscara
        setTimeout(() => updateMaxHeight('section1'), 0);
    }

    function removerTelefone(btn) {
        if (document.querySelectorAll('.telefone-item').length > 1) {
            btn.parentElement.remove();
            setTimeout(() => updateMaxHeight('section1'), 0);
        } else {
            showNotification('error', 'Mantenha pelo menos um telefone!');
        }
    }

    // Idiomas
    function adicionarIdioma() {
        const items = document.querySelectorAll('.idioma-item');
        if (items.length >= 5) { 
            showNotification('error', 'Máximo de 5 idiomas!'); 
            return; 
        }
        const container = document.getElementById('idiomas');
        const div = document.createElement('div');
        div.className = 'idioma-item';
        div.innerHTML = `
            <input type="text" list="idiomas-lista" placeholder="Idioma (ex: Inglês)" class="idioma-nome" required>
            <select class="nivel-idioma">
                <option value="">-- Nível --</option>
                <option value="Básico">Básico</option>
                <option value="Intermediário">Intermediário</option>
                <option value="Avançado">Avançado</option>
                <option value="Fluente">Fluente</option>
                <option value="Nativo">Nativo</option>
            </select>
            <button type="button" class="remove-btn" onclick="removerIdioma(this)"><i class="fas fa-trash"></i> Remover</button>
        `;
        container.appendChild(div);
        setTimeout(() => updateMaxHeight('section4'), 0);
        return div;
    }

    function removerIdioma(btn) {
        if (document.querySelectorAll('.idioma-item').length > 1) {
            btn.parentElement.remove();
            setTimeout(() => updateMaxHeight('section4'), 0);
        } else {
            showNotification('error', 'Mantenha pelo menos um idioma!');
        }
    }

    // Educação
    function adicionarEducacao() {
        const items = document.querySelectorAll('.educacao-item');
        if (items.length >= 5) { 
            showNotification('error', 'Máximo de 5 educações!'); 
            return; 
        }
        const container = document.getElementById('educacoes');
        const div = document.createElement('div');
        div.className = 'educacao-item';
        div.innerHTML = `
            <select class="tipo-educacao">
                <option value="">-- Tipo (opcional) --</option>
                <option value="Ensino Fundamental">Ensino Fundamental</option>
                <option value="Ensino Médio">Ensino Médio</option>
                <option value="Graduação">Graduação</option>
                <option value="Pós-Graduação">Pós-Graduação</option>
                <option value="Mestrado">Mestrado</option>
                <option value="Doutorado">Doutorado</option>
                <option value="Curso Técnico">Curso Técnico</option>
            </select>
            <input type="text" placeholder="Instituição (escola/faculdade)" class="instituicao" required>
            <div class="input-group">
                <input type="number" placeholder="Ano Início (opcional)" class="ano-inicio" min="1900" max="2025">
                <input type="number" placeholder="Ano Término (opcional)" class="ano-termino" min="1900" max="2025">
            </div>
            <button type="button" class="remove-btn" onclick="removerEducacao(this)"><i class="fas fa-trash"></i> Remover</button>
        `;
        container.appendChild(div);
        setTimeout(() => updateMaxHeight('section4'), 0);
        return div;
    }

    function removerEducacao(btn) {
        if (document.querySelectorAll('.educacao-item').length > 1) {
            btn.parentElement.remove();
            setTimeout(() => updateMaxHeight('section4'), 0);
        } else {
            showNotification('error', 'Mantenha pelo menos uma formação!');
        }
    }

    // Experiências
    function adicionarExp() {
        const container = document.getElementById('experiencias');
        const div = document.createElement('div');
        div.className = 'experiencia';
        div.innerHTML = `
            <input type="text" placeholder="Cargo" class="cargo" required>
            <input type="text" placeholder="Empresa" class="empresa" required>
            <input type="text" placeholder="Período (ex: 2014 - 2024)" class="periodo" required>
            <textarea placeholder="Descrição (bullets separadas por ; - opcional)" class="descricao" rows="2"></textarea>
            <button type="button" class="remove-btn" onclick="removerExp(this)"><i class="fas fa-trash"></i> Remover</button>
        `;
        container.appendChild(div);
        setTimeout(() => updateMaxHeight('section3'), 0);
        return div;
    }

    function removerExp(btn) {
        if (document.querySelectorAll('.experiencia').length > 1) {
            btn.parentElement.remove();
            setTimeout(() => updateMaxHeight('section3'), 0);
        } else {
            showNotification('error', 'Mantenha pelo menos uma experiência!');
        }
    }

    function validateStep(step) {
        // Basic validation per step
        switch (step) {
            case 1:
                const nome = document.getElementById('nome').value;
                const email = document.getElementById('email').value;
                if (!nome || !email || !email.includes('@') || !email.includes('.')) {
                    showNotification('error', 'Preencha nome e email válido no passo 1!');
                    return false;
                }
                // Validação telefones
                const tels = document.querySelectorAll('.telefone');
                let hasValidTel = false;
                tels.forEach(tel => {
                    const telValue = tel.value.replace(/\D/g, '');
                    if (telValue.length >= 10) hasValidTel = true;
                    else if (tel.value && telValue.length < 10) {
                        showNotification('error', 'Telefone inválido no passo 1!');
                        return false;
                    }
                });
                if (!hasValidTel) {
                    showNotification('error', 'Adicione pelo menos um telefone válido no passo 1!');
                    return false;
                }
                return true;
            default:
                return true;
        }
    }

    function validarForm() {
        // Validação expandida
        if (!validateStep(1)) return false;

        // Checar pelo menos 1 experiência
        const exps = document.querySelectorAll('.experiencia');
        let hasExp = false;
        exps.forEach(exp => {
            const cargo = exp.querySelector('.cargo').value.trim();
            if (cargo) hasExp = true;
        });
        if (!hasExp) {
            showNotification('error', 'Adicione pelo menos uma experiência profissional!');
            return false;
        }

        // Checar pelo menos 1 educação
        const eduItems = document.querySelectorAll('.educacao-item');
        let hasEdu = false;
        eduItems.forEach(item => {
            const instituicao = item.querySelector('.instituicao').value.trim();
            if (instituicao) hasEdu = true;
        });
        if (!hasEdu) {
            showNotification('error', 'Adicione pelo menos uma formação acadêmica!');
            return false;
        }

        // Checar idiomas se adicionados
        const idiomaItems = document.querySelectorAll('.idioma-item');
        let hasValidIdioma = true;
        idiomaItems.forEach(item => {
            const nome = item.querySelector('.idioma-nome').value.trim();
            const nivel = item.querySelector('.nivel-idioma').value;
            if (nome && !nivel) {
                showNotification('error', 'Selecione o nível para o idioma adicionado!');
                hasValidIdioma = false;
            }
        });
        if (!hasValidIdioma) return false;

        return true;
    }


    function previewCV() {
        if (!validarForm()) return;
        
        // Tema Clássico Fixo: Preto e Branco
        const corAccent = '#000000'; 
        const lineStyle = `border-bottom: 1px solid #000000;`; // Linha mais fina no preview
        
        const preview = document.getElementById('preview');
        
        // Cabeçalho da pré-visualização (Apenas texto, sem ícone)
        let html = '<h2 style="text-align: center; font-size: 1.5em; margin-top: 0; border-bottom: 2px solid #ccc; padding-bottom: 10px; color: #000;">PRÉ-VISUALIZAÇÃO DO SEU CURRÍCULO</h2>';
        
        // Dados pessoais com foto e layout lateral
        html += '<div style="display: flex; align-items: flex-start; margin-bottom: 20px;">';
        const nomeValue = document.getElementById('nome').value;
        if (fotoBase64) {
            html += `<img src="${fotoBase64}" class="foto-preview" alt="Foto de perfil de ${nomeValue}">`;
        }
        html += '<div style="flex: 1;">';
        let nomeText = nomeValue.toUpperCase();
        const civil = document.getElementById('estadoCivil').value;
        const idade = document.getElementById('idade').value;
        const cep = document.getElementById('cep').value;
        const cidade = document.getElementById('cidade').value;
        const uf = document.getElementById('uf').value;
        const end = document.getElementById('endereco').value;
        
        // Dados Pessoais e Endereço (Serão em preto para o preview)
        if (civil || idade) nomeText += `<br><small style="color: ${corAccent};">${civil ? civil + ', ' : ''}${idade ? idade + ' anos' : ''}</small>`;
        if (cep || end || cidade || uf) {
            let addressText = '';
            if (cep) addressText += `${formatarCep(cep)} – `;
            if (end) addressText += `${end} – `;
            if (cidade) addressText += `${cidade} – `;
            if (uf) addressText += `${uf}`;
            nomeText += `<br><small style="color: ${corAccent};">${addressText}</small>`;
        }
        
        html += `<h3 style="color: ${corAccent}; margin: 0;">${nomeText}</h3>`;
        html += '</div></div>';
        
        // Contatos (Sem Ícones)
        html += `<p style="color: ${corAccent}; margin-bottom: 5px;">E-mail: ${document.getElementById('email').value}</p>`;
        
        let telefonesHtml = `<p style="color: ${corAccent}; margin-bottom: 5px;">Telefones: `;
        const tels = document.querySelectorAll('.telefone');
        let hasTel = false;
        tels.forEach((tel, idx) => {
            if (tel.value) {
                hasTel = true;
                const formatted = formatarTelefone(tel.value);
                const isWA = tel.closest('.telefone-group').querySelector('.whatsapp').checked;
                telefonesHtml += `${formatted}${isWA ? ' (WhatsApp)' : ''}${idx < tels.length - 1 ? ', ' : ''}`;
            }
        });
        telefonesHtml += '</p>';
        if (hasTel) html += telefonesHtml;
        const linkedin = document.getElementById('linkedin').value;
        if (linkedin) html += `<p style="color: ${corAccent}; margin-bottom: 5px;">LinkedIn: <a href="${linkedin}" target="_blank" style="color: ${corAccent};">${linkedin}</a></p>`;
        
        
        // Funções auxiliares para seções (Sem Ícones)
        function getTitleHtml(title) {
            return `<h4 style="color: ${corAccent}; ${lineStyle} padding-bottom: 5px; margin-top: 20px;">${title}</h4>`;
        }

        // Objetivo
        const obj = document.getElementById('objetivo').value.trim();
        if (obj) {
            html += getTitleHtml('OBJETIVO');
            html += `<p style="color: ${corAccent};">${obj.toUpperCase()}</p>`;
        }
        
        // Experiências
        const exps = document.querySelectorAll('.experiencia');
        let hasExp = false;
        exps.forEach(exp => {
            const cargo = exp.querySelector('.cargo').value.trim();
            if (cargo) hasExp = true;
        });
        if (hasExp) {
            html += getTitleHtml('EXPERIÊNCIA PROFISSIONAL:');
            exps.forEach(exp => {
                const cargo = exp.querySelector('.cargo').value.trim();
                const empresa = exp.querySelector('.empresa').value.trim();
                const periodo = exp.querySelector('.periodo').value.trim();
                const desc = exp.querySelector('.descricao').value.split(';').map(d => d.trim()).filter(d => d);
                if (cargo) {
                    html += `<h5 style="color: ${corAccent}; margin-top: 15px;">${cargo.toUpperCase()}</h5><p style="color: ${corAccent};"><strong>${empresa}</strong> | ${periodo}</p>`;
                    if (desc.length > 0) {
                        html += '<ul style="color: ' + corAccent + '; margin-top: 5px;">';
                        desc.forEach(bullet => html += `<li style="margin-bottom: 3px;">${bullet}</li>`);
                        html += '</ul>';
                    }
                }
            });
        }
        
        // Educações
        const eduItems = document.querySelectorAll('.educacao-item');
        let hasEdu = false;
        eduItems.forEach(item => {
            const instituicao = item.querySelector('.instituicao').value.trim();
            if (instituicao) hasEdu = true;
        });
        if (hasEdu) {
            html += getTitleHtml('FORMAÇÃO ACADÊMICA:');
            html += '<ul style="color: ' + corAccent + '; margin-top: 5px;">';
            eduItems.forEach(item => {
                const tipo = item.querySelector('.tipo-educacao').value;
                const instituicao = item.querySelector('.instituicao').value.trim();
                const inicio = item.querySelector('.ano-inicio').value;
                const termino = item.querySelector('.ano-termino').value;
                if (instituicao) {
                    let eduText = `${tipo ? tipo + ' – ' : ''}${instituicao}`;
                    if (inicio || termino) eduText += ` (${inicio || ''}${inicio && termino ? ' - ' : ''}${termino || ''})`;
                    html += `<li style="margin-bottom: 3px;">${eduText}</li>`;
                }
            });
            html += '</ul>';
        }
        
        // Idiomas
        const idiomaItems = document.querySelectorAll('.idioma-item');
        let hasIdioma = false;
        idiomaItems.forEach(item => {
            const nome = item.querySelector('.idioma-nome').value.trim();
            if (nome) hasIdioma = true;
        });
        if (hasIdioma) {
            html += getTitleHtml('IDIOMAS:');
            html += '<ul style="color: ' + corAccent + '; margin-top: 5px;">';
            idiomaItems.forEach(item => {
                const nome = item.querySelector('.idioma-nome').value.trim();
                const nivel = item.querySelector('.nivel-idioma').value;
                if (nome) {
                    html += `<li style="margin-bottom: 3px;"><strong>${nome}</strong> - ${nivel}</li>`;
                }
            });
            html += '</ul>';
        }
        
        // Habilidades
        const skills = document.getElementById('skills').value.trim();
        if (skills) {
            html += getTitleHtml('HABILIDADES:');
            html += `<p style="color: ${corAccent};">${skills.replace(/;/g, ', ')}</p>`;
        }
        
        // Adicionais
        const adicional = document.getElementById('adicional').value.trim();
        if (adicional) {
            html += getTitleHtml('DETALHES ADICIONAIS:');
            html += `<p style="color: ${corAccent};">${adicional}</p>`;
        }
        
        preview.innerHTML = html;
        preview.style.display = 'block';
        preview.scrollIntoView({ behavior: 'smooth' });
    }

    function gerarCV() {
        try {
            if (!validarForm()) return;
            
            // Tema Clássico Fixo
            const corPreta = [0, 0, 0]; 
            // const corCinza = [74, 85, 104]; // Não usado mais para texto principal
            
            // Nova Fonte e Espaçamento ajustado
            const fontName = 'times'; 
            const nameFontSize = 24; 
            const titleFontSize = 13; 
            const contentFontSize = 10; 
            const contactFontSize = 9; 
            const lineSpacing = 4.5; 
            const listLineSpacing = 3.5; 
            const sectionSpacing = 7.0; 
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            doc.setFont(fontName, 'normal');
            let y = 20; 

            const exps = document.querySelectorAll('.experiencia');
            const eduItems = document.querySelectorAll('.educacao-item');
            const idiomaItems = document.querySelectorAll('.idioma-item');
            
            const obj = document.getElementById('objetivo').value.trim(); 
            const skills = document.getElementById('skills').value.trim();
            const adicional = document.getElementById('adicional').value.trim();


            // Foto
            const larguraFoto = 25; 
            const alturaFoto = 30;
            if (fotoBase64) {
                try {
                    doc.addImage(fotoBase64, 'JPEG', 15, y, larguraFoto, alturaFoto);
                } catch (imgErr) {
                    // Ignorar erro silenciosamente
                }
            }
            // Nome em caps à direita da foto
            doc.setFontSize(nameFontSize);
            doc.setFont(fontName, 'bold');
            doc.setTextColor(...corPreta);
            const nomePosX = fotoBase64 ? 45 : 20;
            doc.text(document.getElementById('nome').value.toUpperCase(), nomePosX, y + 10);
            y += 18; // Espaço após o nome
            
            // Contatos (CORRIGIDO: Passando para corPreta para melhor legibilidade)
            doc.setFontSize(contactFontSize);
            doc.setFont(fontName, 'normal');
            doc.setTextColor(...corPreta); // <--- CORREÇÃO: Usando Preto para Legibilidade
            
            const civil = document.getElementById('estadoCivil').value;
            const idade = document.getElementById('idade').value;
            const cep = document.getElementById('cep').value;
            const cidade = document.getElementById('cidade').value;
            const uf = document.getElementById('uf').value;
            const end = document.getElementById('endereco').value;
            
            let civilAgeText = '';
            if (civil || idade) civilAgeText = `${civil ? civil + ', ' : ''}${idade ? idade + ' anos' : ''}`;
            let addressText = '';
            if (cep || end || cidade || uf) {
                if (cep) addressText += `${formatarCep(cep)} – `;
                if (end) addressText += `${end} – `;
                if (cidade) addressText += `${cidade} – `;
                if (uf) addressText += `${uf}`;
            }
            if (civilAgeText) {
                doc.text(civilAgeText, nomePosX, y);
                y += lineSpacing - 1.5; 
            }
            if (addressText) {
                doc.text(addressText, nomePosX, y);
                y += lineSpacing - 1.5;
            }

            // Email 
            doc.text('E-mail: ' + document.getElementById('email').value, nomePosX, y);
            y += lineSpacing - 1.5;
            
            // Telefones 
            let telText = '';
            const tels = document.querySelectorAll('.telefone');
            let firstTel = true;
            tels.forEach(tel => {
                if (tel.value.trim()) {
                    if (!firstTel) telText += ', ';
                    const formatted = formatarTelefone(tel.value);
                    const isWA = tel.closest('.telefone-group').querySelector('.whatsapp').checked;
                    telText += `${formatted}${isWA ? ' (WhatsApp)' : ''}`;
                    firstTel = false;
                }
            });
            if (telText) {
                const maxWidth = 170;
                doc.setFont(fontName, 'normal');
                const splitTexts = doc.splitTextToSize('Telefone: ' + telText, maxWidth); 
                splitTexts.forEach((line, index) => {
                    doc.text(line, nomePosX, y + (index * listLineSpacing));
                });
                y += splitTexts.length * listLineSpacing + 2; 
            }
            
            const linkedin = document.getElementById('linkedin').value;
            if (linkedin) {
                doc.text('LinkedIn: ' + linkedin, nomePosX, y); 
                y += lineSpacing - 1.5;
            }

            // Espaço extra antes das seções
            y += 8;

            // Linha separadora principal (REMOVIDA)

            // Seções principais
            const sections = [
                { title: 'OBJETIVO', content: obj, hasContent: (c) => c.trim() !== '' },
                { title: 'EXPERIÊNCIA PROFISSIONAL', content: exps, hasContent: (c) => Array.from(c).some(exp => exp.querySelector('.cargo').value.trim()) },
                { title: 'FORMAÇÃO ACADÊMICA', content: eduItems, hasContent: (c) => Array.from(c).some(item => item.querySelector('.instituicao').value.trim()) },
                { title: 'IDIOMAS', content: idiomaItems, hasContent: (c) => Array.from(c).some(item => item.querySelector('.idioma-nome').value.trim()) },
                { title: 'HABILIDADES', content: skills, hasContent: (c) => c.trim() !== '' },
                { title: 'DETALHES ADICIONAIS', content: adicional, hasContent: (c) => c.trim() !== '' }
            ];

            sections.forEach(section => {
                if (section.hasContent(section.content)) {
                    
                    // Título da seção 
                    doc.setFontSize(titleFontSize);
                    doc.setFont(fontName, 'bold');
                    doc.setTextColor(...corPreta); 
                    doc.setLineWidth(0.5); 
                    doc.setDrawColor(...corPreta);
                    
                    // Linha sublinhada em preto
                    doc.text(section.title, 20, y);
                    doc.line(20, y + 1, 190, y + 1); 
                    
                    y += 6; // Espaço após o título
                    
                    doc.setFontSize(contentFontSize);
                    doc.setFont(fontName, 'normal');
                    doc.setTextColor(...corPreta); 

                    if (section.title === 'OBJETIVO') {
                        doc.setFont(fontName, 'bold'); 
                        const splitObj = doc.splitTextToSize(section.content.toUpperCase(), 170);
                        splitObj.forEach((line, index) => {
                            doc.text(line, 20, y + (index * lineSpacing));
                        });
                        y += splitObj.length * lineSpacing + 2;
                        doc.setFont(fontName, 'normal');
                    } else if (section.title === 'EXPERIÊNCIA PROFISSIONAL') {
                        const expsLocal = section.content;
                        Array.from(expsLocal).forEach(exp => {
                            const cargo = exp.querySelector('.cargo').value.trim();
                            if (cargo) {
                                doc.setFont(fontName, 'bold');
                                doc.setFontSize(contentFontSize);
                                doc.text(cargo.toUpperCase(), 20, y);
                                
                                y += lineSpacing;
                                doc.setFontSize(contentFontSize);
                                const empresa = exp.querySelector('.empresa').value.trim();
                                const periodo = exp.querySelector('.periodo').value.trim();
                                
                                if (empresa || periodo) {
                                    if (empresa) {
                                        doc.setFont(fontName, 'bold');
                                        doc.text(empresa, 20, y);
                                        const empWidth = doc.getTextWidth(empresa);
                                        doc.setFont(fontName, 'normal');
                                        if (periodo) {
                                            doc.text(` | ${periodo}`, 20 + empWidth, y);
                                        }
                                    } else if (periodo) {
                                        doc.setFont(fontName, 'normal');
                                        doc.text(periodo, 20, y);
                                    }
                                }
                                y += lineSpacing;
                                const desc = exp.querySelector('.descricao').value.split(';').map(d => d.trim()).filter(d => d);
                                if (desc.length > 0) {
                                    desc.forEach(bullet => {
                                        const splitBullet = doc.splitTextToSize(`• ${bullet}`, 170);
                                        splitBullet.forEach((line, index) => {
                                            doc.text(line, 25, y + (index * listLineSpacing));
                                        });
                                        y += splitBullet.length * listLineSpacing + 1.5;
                                    });
                                }
                                y += 3; // Espaço entre experiências
                            }
                        });
                    } else if (['FORMAÇÃO ACADÊMICA', 'IDIOMAS'].includes(section.title)) {
                        const items = section.content;
                        Array.from(items).forEach(item => {
                            let text = '';
                            let isBoldName = false;
                            let nome = '';
                            let rest = '';
                            if (section.title === 'FORMAÇÃO ACADÊMICA') {
                                const tipo = item.querySelector('.tipo-educacao').value;
                                const instituicao = item.querySelector('.instituicao').value.trim();
                                const inicio = item.querySelector('.ano-inicio').value;
                                const termino = item.querySelector('.ano-termino').value;
                                if (instituicao) text = `${tipo ? tipo + ' – ' : ''}${instituicao}${inicio || termino ? ` (${inicio || ''}${inicio && termino ? ' - ' : ''}${termino || ''})` : ''}`;
                            } else if (section.title === 'IDIOMAS') {
                                nome = item.querySelector('.idioma-nome').value.trim();
                                const nivel = item.querySelector('.nivel-idioma').value;
                                if (nome) {
                                    isBoldName = true;
                                    rest = ` - ${nivel}`;
                                }
                            }
                            if (text || nome) {
                                if (isBoldName) {
                                    doc.setFont(fontName, 'bold');
                                    doc.text(nome, 20, y);
                                    const nomeWidth = doc.getTextWidth(nome);
                                    doc.setFont(fontName, 'normal');
                                    if (rest) {
                                        doc.text(rest, 20 + nomeWidth, y);
                                    }
                                } else {
                                    const splitText = doc.splitTextToSize(text, 170);
                                    splitText.forEach((line, index) => {
                                        doc.text(line, 20, y + (index * listLineSpacing));
                                    });
                                }
                                y += listLineSpacing;
                            }
                        });
                        y += 3;
                    } else if (section.title === 'HABILIDADES') {
                        doc.setFont(fontName, 'bold');
                        const skillText = section.content.replace(/;/g, ', ');
                        const splitSkills = doc.splitTextToSize(skillText, 170);
                        splitSkills.forEach((line, index) => {
                            doc.text(line, 20, y + (index * lineSpacing));
                        });
                        y += splitSkills.length * lineSpacing + 2;
                        doc.setFont(fontName, 'normal');
                    } else if (section.title === 'DETALHES ADICIONAIS') {
                        const splitAdic = doc.splitTextToSize(section.content, 170);
                        splitAdic.forEach((line, index) => {
                            doc.text(line, 20, y + (index * lineSpacing));
                        });
                        y += splitAdic.length * lineSpacing + 2;
                    }
                    y += sectionSpacing;
                    
                    // Adicionar nova página se necessário
                    if (y > 275) { 
                        doc.addPage();
                        y = 20;
                    }
                }
            });

            const nomePessoa = document.getElementById('nome').value.replace(/[^a-zA-Z0-9]/g, '_');
            const nomeArquivo = `Curriculo_${nomePessoa}_Classico.pdf`;
            doc.save(nomeArquivo);
            showNotification('success', 'Seu CV foi gerado com sucesso! Baixe o PDF e conquiste novas oportunidades.');
        } catch (e) {
            showNotification('error', `Erro ao gerar PDF: ${e.message}. Tente novamente.`);
        }
    }
</script>
</body>
</html>
